# Phase 1.2: Design System Components

## Objective

Build a comprehensive library of reusable Vue.js components that will be used across all screens in the App Merge UI.

## Prerequisites

- Phase 1.1 (Project Setup) completed
- Vue.js 3 loaded and available
- Global CSS with design tokens in place

## Component List

### Core Components

1. **MergeButton** - Standardized button with variants
2. **MergeCard** - Card container with consistent styling
3. **MergeAlert** - Alert/notification boxes
4. **MergeModal** - Modal dialog overlays
5. **MergeBadge** - Status and count badges
6. **MergeProgressBar** - Progress indicator
7. **MergeStepper** - Multi-step navigation indicator
8. **MergeLoadingSpinner** - Loading state indicator
9. **MergeLockTimer** - Countdown timer for lock expiry

### Component Implementations

Add these components to Global JS:

```javascript
// Wait for Vue to load before defining components
window.addEventListener('vue-loaded', function() {
  var Vue = window.Vue;

  // 1. MergeButton Component
  Vue.component('merge-button', {
    props: {
      variant: {
        type: String,
        default: 'primary' // primary, secondary, danger, success, warning, info
      },
      size: {
        type: String,
        default: 'md' // sm, md, lg
      },
      disabled: Boolean,
      loading: Boolean,
      block: Boolean,
      outline: Boolean
    },
    template: `
      <button
        :class="buttonClasses"
        :disabled="disabled || loading"
        @click="$emit('click', $event)">
        <i v-if="loading" class="fa fa-spinner fa-spin mr-1"></i>
        <slot></slot>
      </button>
    `,
    computed: {
      buttonClasses: function() {
        var classes = ['merge-btn'];
        classes.push('merge-btn-' + this.size);
        classes.push(this.outline ? 'merge-btn-outline-' + this.variant : 'merge-btn-' + this.variant);
        if (this.block) classes.push('merge-btn-block');
        if (this.disabled || this.loading) classes.push('disabled');
        return classes;
      }
    }
  });

  // 2. MergeCard Component
  Vue.component('merge-card', {
    props: {
      title: String,
      subtitle: String,
      noPadding: Boolean,
      shadow: {
        type: String,
        default: 'md' // sm, md, lg, xl
      }
    },
    template: `
      <div :class="'merge-card shadow-' + shadow">
        <div v-if="title || subtitle || $slots.header" class="merge-card-header">
          <div v-if="title || subtitle">
            <h3 v-if="title" class="merge-card-title">{{ title }}</h3>
            <p v-if="subtitle" class="merge-card-subtitle">{{ subtitle }}</p>
          </div>
          <slot name="header"></slot>
        </div>
        <div :class="['merge-card-body', { 'no-padding': noPadding }]">
          <slot></slot>
        </div>
        <div v-if="$slots.footer" class="merge-card-footer">
          <slot name="footer"></slot>
        </div>
      </div>
    `
  });

  // 3. MergeAlert Component
  Vue.component('merge-alert', {
    props: {
      type: {
        type: String,
        default: 'info' // info, success, warning, danger
      },
      dismissible: Boolean,
      icon: String
    },
    data: function() {
      return {
        visible: true
      };
    },
    computed: {
      defaultIcon: function() {
        var icons = {
          info: 'fa-info-circle',
          success: 'fa-check-circle',
          warning: 'fa-exclamation-triangle',
          danger: 'fa-times-circle'
        };
        return this.icon || icons[this.type];
      }
    },
    template: `
      <div v-if="visible" :class="'merge-alert merge-alert-' + type">
        <i :class="'fa ' + defaultIcon + ' merge-alert-icon'"></i>
        <div class="merge-alert-content">
          <slot></slot>
        </div>
        <button v-if="dismissible" class="merge-alert-close" @click="visible = false">
          <i class="fa fa-times"></i>
        </button>
      </div>
    `
  });

  // 4. MergeModal Component
  Vue.component('merge-modal', {
    props: {
      show: Boolean,
      title: String,
      size: {
        type: String,
        default: 'md' // sm, md, lg, xl
      },
      closeOnBackdrop: {
        type: Boolean,
        default: true
      }
    },
    watch: {
      show: function(newVal) {
        if (newVal) {
          document.body.classList.add('modal-open');
        } else {
          document.body.classList.remove('modal-open');
        }
      }
    },
    methods: {
      handleBackdropClick: function() {
        if (this.closeOnBackdrop) {
          this.$emit('update:show', false);
          this.$emit('close');
        }
      }
    },
    template: `
      <transition name="modal-fade">
        <div v-if="show" class="merge-modal" @click.self="handleBackdropClick">
          <div :class="'merge-modal-dialog merge-modal-' + size">
            <div class="merge-modal-content">
              <div class="merge-modal-header">
                <h4 class="merge-modal-title">{{ title }}</h4>
                <button class="merge-modal-close" @click="$emit('update:show', false); $emit('close')">
                  <i class="fa fa-times"></i>
                </button>
              </div>
              <div class="merge-modal-body">
                <slot></slot>
              </div>
              <div v-if="$slots.footer" class="merge-modal-footer">
                <slot name="footer"></slot>
              </div>
            </div>
          </div>
        </div>
      </transition>
    `
  });

  // 5. MergeBadge Component
  Vue.component('merge-badge', {
    props: {
      variant: {
        type: String,
        default: 'secondary' // primary, secondary, success, warning, danger, info
      },
      pill: Boolean,
      size: {
        type: String,
        default: 'md' // sm, md, lg
      }
    },
    template: `
      <span :class="badgeClasses">
        <slot></slot>
      </span>
    `,
    computed: {
      badgeClasses: function() {
        var classes = ['merge-badge', 'merge-badge-' + this.variant, 'merge-badge-' + this.size];
        if (this.pill) classes.push('merge-badge-pill');
        return classes;
      }
    }
  });

  // 6. MergeProgressBar Component
  Vue.component('merge-progress-bar', {
    props: {
      value: {
        type: Number,
        required: true,
        validator: function(val) {
          return val >= 0 && val <= 100;
        }
      },
      variant: {
        type: String,
        default: 'primary'
      },
      striped: Boolean,
      animated: Boolean,
      showLabel: Boolean
    },
    template: `
      <div class="merge-progress">
        <div
          :class="progressBarClasses"
          :style="{ width: value + '%' }"
          role="progressbar"
          :aria-valuenow="value"
          aria-valuemin="0"
          aria-valuemax="100">
          <span v-if="showLabel">{{ value }}%</span>
        </div>
      </div>
    `,
    computed: {
      progressBarClasses: function() {
        var classes = ['merge-progress-bar', 'merge-progress-bar-' + this.variant];
        if (this.striped) classes.push('merge-progress-bar-striped');
        if (this.animated) classes.push('merge-progress-bar-animated');
        return classes;
      }
    }
  });

  // 7. MergeStepper Component
  Vue.component('merge-stepper', {
    props: {
      steps: {
        type: Array,
        required: true
        // Example: [{ label: 'Step 1', complete: false }, ...]
      },
      currentStep: {
        type: Number,
        required: true
      }
    },
    template: `
      <div class="merge-stepper">
        <div
          v-for="(step, index) in steps"
          :key="index"
          :class="stepClasses(index)"
          @click="$emit('step-click', index)">
          <div class="merge-stepper-icon">
            <i v-if="step.complete" class="fa fa-check"></i>
            <span v-else>{{ index + 1 }}</span>
          </div>
          <div class="merge-stepper-label">{{ step.label }}</div>
          <div v-if="index < steps.length - 1" class="merge-stepper-line"></div>
        </div>
      </div>
    `,
    methods: {
      stepClasses: function(index) {
        return {
          'merge-stepper-step': true,
          'active': index === this.currentStep,
          'complete': this.steps[index].complete,
          'clickable': index < this.currentStep
        };
      }
    }
  });

  // 8. MergeLoadingSpinner Component
  Vue.component('merge-loading-spinner', {
    props: {
      size: {
        type: String,
        default: 'md' // sm, md, lg
      },
      overlay: Boolean,
      message: String
    },
    template: `
      <div :class="spinnerClasses">
        <div class="merge-spinner-icon">
          <i class="fa fa-spinner fa-spin"></i>
        </div>
        <p v-if="message" class="merge-spinner-message">{{ message }}</p>
      </div>
    `,
    computed: {
      spinnerClasses: function() {
        var classes = ['merge-loading-spinner', 'merge-spinner-' + this.size];
        if (this.overlay) classes.push('merge-spinner-overlay');
        return classes;
      }
    }
  });

  // 9. MergeLockTimer Component
  Vue.component('merge-lock-timer', {
    props: {
      lockedUntil: {
        type: Number,
        required: true
      }
    },
    data: function() {
      return {
        timeRemaining: 0,
        warningThreshold: 2 * 60 * 1000, // 2 minutes
        updateInterval: null
      };
    },
    mounted: function() {
      this.startTimer();
    },
    beforeUnmount: function() {
      if (this.updateInterval) {
        clearInterval(this.updateInterval);
      }
    },
    computed: {
      formattedTime: function() {
        var minutes = Math.floor(this.timeRemaining / 60000);
        var seconds = Math.floor((this.timeRemaining % 60000) / 1000);
        return minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
      },
      isWarning: function() {
        return this.timeRemaining <= this.warningThreshold && this.timeRemaining > 0;
      },
      isExpired: function() {
        return this.timeRemaining <= 0;
      }
    },
    methods: {
      startTimer: function() {
        var self = this;
        this.updateInterval = setInterval(function() {
          self.updateTimeRemaining();
        }, 1000);
        this.updateTimeRemaining();
      },
      updateTimeRemaining: function() {
        this.timeRemaining = Math.max(0, this.lockedUntil - Date.now());
        MergeState.lockInfo.timeRemaining = this.timeRemaining;

        if (this.isExpired) {
          this.$emit('expired');
          if (this.updateInterval) {
            clearInterval(this.updateInterval);
          }
        }
      },
      extend: function() {
        this.$emit('extend');
      }
    },
    template: `
      <div :class="['merge-lock-timer', { 'warning': isWarning, 'expired': isExpired }]">
        <i class="fa fa-clock-o mr-2"></i>
        <span class="timer-text">
          Lock expires in: <strong>{{ formattedTime }}</strong>
        </span>
        <button
          v-if="isWarning && !isExpired"
          class="btn btn-sm btn-warning ml-2"
          @click="extend">
          Extend Lock
        </button>
        <span v-if="isExpired" class="expired-text">
          <i class="fa fa-exclamation-triangle mr-1"></i>
          Lock Expired!
        </span>
      </div>
    `
  });

  console.log('Design System components registered');
});
```

## Component Styles

Add these styles to Global CSS:

```css
/* Button Styles */
.merge-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 8px 16px;
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  line-height: 1.5;
  border: var(--border-width) solid transparent;
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: all var(--transition-fast);
  text-decoration: none;
}

.merge-btn:hover:not(.disabled) {
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.merge-btn:active:not(.disabled) {
  transform: translateY(0);
}

.merge-btn.disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* Button Sizes */
.merge-btn-sm {
  padding: 4px 12px;
  font-size: var(--font-size-sm);
}

.merge-btn-lg {
  padding: 12px 24px;
  font-size: var(--font-size-lg);
}

.merge-btn-block {
  display: flex;
  width: 100%;
}

/* Button Variants */
.merge-btn-primary {
  background-color: var(--primary-color);
  color: white;
}

.merge-btn-secondary {
  background-color: var(--secondary-color);
  color: white;
}

.merge-btn-success {
  background-color: var(--success-color);
  color: white;
}

.merge-btn-warning {
  background-color: var(--warning-color);
  color: white;
}

.merge-btn-danger {
  background-color: var(--danger-color);
  color: white;
}

/* Outline Button Variants */
.merge-btn-outline-primary {
  background-color: transparent;
  color: var(--primary-color);
  border-color: var(--primary-color);
}

.merge-btn-outline-primary:hover:not(.disabled) {
  background-color: var(--primary-color);
  color: white;
}

/* Card Styles */
.merge-card {
  background: white;
  border-radius: var(--border-radius-md);
  margin-bottom: var(--spacing-md);
  overflow: hidden;
}

.shadow-sm { box-shadow: var(--shadow-sm); }
.shadow-md { box-shadow: var(--shadow-md); }
.shadow-lg { box-shadow: var(--shadow-lg); }
.shadow-xl { box-shadow: var(--shadow-xl); }

.merge-card-header {
  padding: var(--spacing-md) var(--spacing-lg);
  border-bottom: var(--border-width) solid var(--border-color-light);
  background-color: #f8f9fa;
}

.merge-card-title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--secondary-color);
}

.merge-card-subtitle {
  margin: var(--spacing-xs) 0 0 0;
  font-size: var(--font-size-sm);
  color: #6c757d;
}

.merge-card-body {
  padding: var(--spacing-lg);
}

.merge-card-body.no-padding {
  padding: 0;
}

.merge-card-footer {
  padding: var(--spacing-md) var(--spacing-lg);
  border-top: var(--border-width) solid var(--border-color-light);
  background-color: #f8f9fa;
}

/* Alert Styles */
.merge-alert {
  display: flex;
  align-items: flex-start;
  padding: var(--spacing-md);
  border-radius: var(--border-radius);
  margin-bottom: var(--spacing-md);
  border: var(--border-width) solid transparent;
}

.merge-alert-icon {
  font-size: var(--font-size-lg);
  margin-right: var(--spacing-sm);
  flex-shrink: 0;
}

.merge-alert-content {
  flex: 1;
}

.merge-alert-close {
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
  margin-left: var(--spacing-sm);
  opacity: 0.7;
  transition: opacity var(--transition-fast);
}

.merge-alert-close:hover {
  opacity: 1;
}

.merge-alert-info {
  background-color: #d1ecf1;
  border-color: #bee5eb;
  color: #0c5460;
}

.merge-alert-success {
  background-color: #d4edda;
  border-color: #c3e6cb;
  color: #155724;
}

.merge-alert-warning {
  background-color: #fff3cd;
  border-color: #ffeaa7;
  color: #856404;
}

.merge-alert-danger {
  background-color: #f8d7da;
  border-color: #f5c6cb;
  color: #721c24;
}

/* Modal Styles */
.merge-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: var(--z-modal);
  padding: var(--spacing-lg);
}

.merge-modal-dialog {
  background: white;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-xl);
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
}

.merge-modal-sm { max-width: 400px; }
.merge-modal-md { max-width: 600px; }
.merge-modal-lg { max-width: 900px; }
.merge-modal-xl { max-width: 1200px; }

.merge-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-lg);
  border-bottom: var(--border-width) solid var(--border-color-light);
}

.merge-modal-title {
  margin: 0;
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-semibold);
}

.merge-modal-close {
  background: none;
  border: none;
  font-size: var(--font-size-xl);
  cursor: pointer;
  padding: 0;
  opacity: 0.7;
  transition: opacity var(--transition-fast);
}

.merge-modal-close:hover {
  opacity: 1;
}

.merge-modal-body {
  padding: var(--spacing-lg);
}

.merge-modal-footer {
  padding: var(--spacing-lg);
  border-top: var(--border-width) solid var(--border-color-light);
  display: flex;
  justify-content: flex-end;
  gap: var(--spacing-sm);
}

/* Modal transition */
.modal-fade-enter-active, .modal-fade-leave-active {
  transition: opacity var(--transition-base);
}

.modal-fade-enter-from, .modal-fade-leave-to {
  opacity: 0;
}

/* Badge Styles */
.merge-badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-semibold);
  line-height: 1;
  border-radius: var(--border-radius);
  white-space: nowrap;
}

.merge-badge-sm {
  padding: 1px 6px;
  font-size: var(--font-size-xs);
}

.merge-badge-lg {
  padding: 4px 12px;
  font-size: var(--font-size-base);
}

.merge-badge-pill {
  border-radius: var(--border-radius-full);
}

.merge-badge-primary { background-color: var(--primary-color); color: white; }
.merge-badge-secondary { background-color: var(--secondary-color); color: white; }
.merge-badge-success { background-color: var(--success-color); color: white; }
.merge-badge-warning { background-color: var(--warning-color); color: white; }
.merge-badge-danger { background-color: var(--danger-color); color: white; }
.merge-badge-info { background-color: var(--info-color); color: white; }

/* Progress Bar Styles */
.merge-progress {
  height: 20px;
  background-color: #e9ecef;
  border-radius: var(--border-radius);
  overflow: hidden;
}

.merge-progress-bar {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-semibold);
  transition: width var(--transition-base);
}

.merge-progress-bar-primary { background-color: var(--primary-color); }
.merge-progress-bar-success { background-color: var(--success-color); }
.merge-progress-bar-warning { background-color: var(--warning-color); }
.merge-progress-bar-danger { background-color: var(--danger-color); }

.merge-progress-bar-striped {
  background-image: linear-gradient(
    45deg,
    rgba(255, 255, 255, 0.15) 25%,
    transparent 25%,
    transparent 50%,
    rgba(255, 255, 255, 0.15) 50%,
    rgba(255, 255, 255, 0.15) 75%,
    transparent 75%,
    transparent
  );
  background-size: 20px 20px;
}

.merge-progress-bar-animated {
  animation: progress-bar-stripes 1s linear infinite;
}

@keyframes progress-bar-stripes {
  0% { background-position: 20px 0; }
  100% { background-position: 0 0; }
}

/* Stepper Styles */
.merge-stepper {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: var(--spacing-lg) 0;
}

.merge-stepper-step {
  display: flex;
  align-items: center;
  flex: 1;
  position: relative;
}

.merge-stepper-icon {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background-color: #e9ecef;
  color: #6c757d;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: var(--font-weight-semibold);
  transition: all var(--transition-base);
  z-index: 1;
}

.merge-stepper-step.active .merge-stepper-icon {
  background-color: var(--primary-color);
  color: white;
}

.merge-stepper-step.complete .merge-stepper-icon {
  background-color: var(--success-color);
  color: white;
}

.merge-stepper-label {
  position: absolute;
  top: 100%;
  left: 0;
  margin-top: var(--spacing-sm);
  font-size: var(--font-size-sm);
  white-space: nowrap;
}

.merge-stepper-line {
  flex: 1;
  height: 2px;
  background-color: #e9ecef;
  margin: 0 var(--spacing-sm);
}

.merge-stepper-step.complete .merge-stepper-line {
  background-color: var(--success-color);
}

/* Loading Spinner Styles */
.merge-loading-spinner {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-xl);
}

.merge-spinner-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.9);
  z-index: var(--z-modal);
}

.merge-spinner-icon {
  font-size: 2rem;
  color: var(--primary-color);
}

.merge-spinner-sm .merge-spinner-icon { font-size: 1rem; }
.merge-spinner-lg .merge-spinner-icon { font-size: 3rem; }

.merge-spinner-message {
  margin-top: var(--spacing-md);
  font-size: var(--font-size-base);
  color: var(--secondary-color);
}

/* Lock Timer Styles */
.merge-lock-timer {
  display: flex;
  align-items: center;
  padding: var(--spacing-sm) var(--spacing-md);
  background-color: #f8f9fa;
  border: var(--border-width) solid var(--border-color);
  border-radius: var(--border-radius);
  font-size: var(--font-size-sm);
}

.merge-lock-timer.warning {
  background-color: #fff3cd;
  border-color: #ffeaa7;
  color: #856404;
}

.merge-lock-timer.expired {
  background-color: #f8d7da;
  border-color: #f5c6cb;
  color: #721c24;
}

.timer-text strong {
  font-weight: var(--font-weight-bold);
}

.expired-text {
  color: var(--danger-color);
  font-weight: var(--font-weight-semibold);
}
```

## Design System Showcase Screen

Create a screen named `== [Design System] ==` to showcase all components:

See detailed HTML in the implementation plan.

## Verification

- [ ] All 9 components are registered and accessible
- [ ] Components render correctly in isolation
- [ ] Component styles are applied from Global CSS
- [ ] Props and events work as expected
- [ ] Design system showcase screen displays all components
- [ ] Components are responsive and accessible

## Next Steps

Proceed to [1.3 API Middleware Layer](./1.3-api-middleware.md) to build the API integration layer.

